import{h as A,r as B,k as w,i as se,j as re,e as r,o as ne,c as ie,w as t,f as e,g as n,a as i,t as p,l as de,O as E}from"./app-iB3bdkkX.js";import{_ as ce}from"./AdminLayout-D1QKAjQw.js";const ue=i("div",{class:"text-subtitle-2 text-medium-emphasis"},"Total Products",-1),me={class:"text-h6 font-weight-bold"},fe=i("div",{class:"text-subtitle-2 text-medium-emphasis"},"In Stock",-1),pe={class:"text-h6 font-weight-bold"},_e=i("div",{class:"text-subtitle-2 text-medium-emphasis"},"Out of Stock",-1),ve={class:"text-h6 font-weight-bold"},ge=i("span",{class:"text-h5"},"Products",-1),ye={class:"font-weight-medium"},be={class:"text-h5"},xe={__name:"Products",props:{products:{type:Object,required:!0}},setup(x){const V=x,U=A(()=>{const a=V.products.map(y=>y.category);return[...new Set(a)]});console.log();const Q=["In Stock","Out of Stock"],G=[{title:"Image",key:"image",sortable:!1,align:"center"},{title:"Name",key:"name",align:"start"},{title:"Category",key:"category",align:"start"},{title:"Price",key:"price",align:"end"},{title:"Quantity",key:"quantity",align:"end"},{title:"Status",key:"status",align:"center"},{title:"Actions",key:"actions",sortable:!1,align:"center"}],m=B(!1),k=B(null),c=w({search:"",category:null,status:null}),g=w({show:!1,isEdit:!1}),u=w({show:!1,item:null}),_=w({show:!1,text:"",color:"success"}),s=w({id:"",name:"",category:"",price:0,quantity:0,description:"",image:"",imageFile:null}),H=a=>a<=0?"Out Of stock":"In Stock",J=A(()=>{let a=[...V.products];return c.category&&(a=a.filter(l=>l.category===c.category)),c.status==="In Stock"&&(a=a.filter(l=>l.quantity>0)),c.status==="Out of Stock"&&(a=a.filter(l=>l.quantity<=0)),a}),z=()=>{s.id="",s.name="",s.category="",s.price=0,s.quantity=0,s.description="",s.image="",s.imageFile=null,k.value&&k.value.resetValidation()},O=(a=null)=>{g.isEdit=!!a,a?Object.keys(s).forEach(l=>{s[l]=a[l]}):z(),g.show=!0},$=()=>{g.show=!1,z()},K=a=>a<=0?"Out of Stock":"In Stock",f=(a,l="success")=>{_.text=a,_.color=l,_.show=!0},N=async()=>{var a;if((a=k.value)!=null&&a.validate()){m.value=!0;try{if(await new Promise(l=>setTimeout(l,1e3)),g.isEdit){const l=V.products.find(y=>y.id===s.id);s._method="PUT",E.post(`/admin/products/${l.id}`,s,{onSuccess:()=>{f("Product Update successfully")},onError:()=>{f("Error saving product. Please try again.","error")}})}else E.post("/admin/products",s,{onSuccess:()=>{f("Product added successfully")},onError:()=>{f("Error saving product. Please try again.","error")}});$()}catch{f("Error saving product. Please try again.","error")}finally{m.value=!1}}},L=a=>{u.item=a,u.show=!0},R=async()=>{if(u.item){m.value=!0;try{await new Promise(l=>setTimeout(l,1e3));const a=V.products.find(l=>l.id===u.item.id);E.delete(`/admin/products/${a.id}`,{onSuccess:()=>{f("Product deleted successfully")},onError:()=>{f("Error deleting product. Please try again.","error")}}),u.show=!1,u.item=null}catch(a){console.error("Error deleting product:",a),f("Error deleting product. Please try again.","error")}finally{m.value=!1}}};se(()=>s.stock,a=>{s.status=K(a)}),re(async()=>{m.value=!0;try{await new Promise(a=>setTimeout(a,1e3))}catch(a){console.error("Error fetching products:",a),f("Error loading products","error")}finally{m.value=!1}});const W=a=>Number(a)>=1?"success":"error";return(a,l)=>{const y=r("v-icon"),P=r("v-avatar"),b=r("v-card-text"),h=r("v-card"),d=r("v-col"),C=r("v-row"),v=r("v-btn"),q=r("v-card-title"),S=r("v-text-field"),D=r("v-select"),X=r("v-img"),F=r("v-chip"),Y=r("v-data-table"),Z=r("v-file-input"),ee=r("v-combobox"),te=r("v-textarea"),I=r("v-container"),oe=r("v-form"),T=r("v-spacer"),j=r("v-card-actions"),M=r("v-dialog"),le=r("v-snackbar");return ne(),ie(ce,null,{default:t(()=>[e(I,{fluid:"",class:"pa-6"},{default:t(()=>[e(C,{class:"mb-6"},{default:t(()=>[e(d,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(h,{class:"rounded-lg"},{default:t(()=>[e(b,{class:"d-flex align-center"},{default:t(()=>[e(P,{color:"primary",size:"48",class:"me-4"},{default:t(()=>[e(y,{color:"white",size:"24"},{default:t(()=>[n("mdi-package-variant")]),_:1})]),_:1}),i("div",null,[ue,i("div",me,p(x.products.length),1)])]),_:1})]),_:1})]),_:1}),e(d,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(h,{class:"rounded-lg"},{default:t(()=>[e(b,{class:"d-flex align-center"},{default:t(()=>[e(P,{color:"success",size:"48",class:"me-4"},{default:t(()=>[e(y,{color:"white",size:"24"},{default:t(()=>[n("mdi-check-circle")]),_:1})]),_:1}),i("div",null,[fe,i("div",pe,p(x.products.filter(o=>o.quantity>=0).length),1)])]),_:1})]),_:1})]),_:1}),e(d,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(h,{class:"rounded-lg"},{default:t(()=>[e(b,{class:"d-flex align-center"},{default:t(()=>[e(P,{color:"error",size:"48",class:"me-4"},{default:t(()=>[e(y,{color:"white",size:"24"},{default:t(()=>[n("mdi-close-circle")]),_:1})]),_:1}),i("div",null,[_e,i("div",ve,p(x.products.filter(o=>o.quantity<=0).length),1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(h,{class:"rounded-lg"},{default:t(()=>[e(q,{class:"d-flex justify-space-between align-center pa-6"},{default:t(()=>[ge,e(v,{color:"primary","prepend-icon":"mdi-plus",onClick:l[0]||(l[0]=o=>O()),variant:"elevated"},{default:t(()=>[n(" Add Product ")]),_:1})]),_:1}),e(b,null,{default:t(()=>[e(C,null,{default:t(()=>[e(d,{cols:"12",sm:"4"},{default:t(()=>[e(S,{modelValue:c.search,"onUpdate:modelValue":l[1]||(l[1]=o=>c.search=o),label:"Search products","prepend-inner-icon":"mdi-magnify",clearable:"","hide-details":"",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"4"},{default:t(()=>[e(D,{modelValue:c.category,"onUpdate:modelValue":l[2]||(l[2]=o=>c.category=o),items:U.value,label:"Category",clearable:"","hide-details":"",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12",sm:"4"},{default:t(()=>[e(D,{modelValue:c.status,"onUpdate:modelValue":l[3]||(l[3]=o=>c.status=o),items:Q,label:"Status",clearable:"","hide-details":"",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Y,{headers:G,items:J.value,loading:m.value,search:c.search,hover:""},{"item.image":t(({item:o})=>[e(P,{rounded:"",size:"48"},{default:t(()=>[e(X,{src:o.image?`/storage/${o.image}`:"/image/Place_holder.jpg",cover:""},null,8,["src"])]),_:2},1024)]),"item.price":t(({item:o})=>[i("span",ye,"$"+p(o.price.toFixed(2)),1)]),"item.status":t(({item:o})=>[e(F,{color:W(o.quantity),size:"small",variant:"elevated"},{default:t(()=>[n(p(H(o.quantity)),1)]),_:2},1032,["color"])]),"item.actions":t(({item:o})=>[e(v,{icon:"mdi-pencil",size:"small",color:"primary",variant:"text",onClick:ae=>O(o)},null,8,["onClick"]),e(v,{icon:"mdi-delete",size:"small",color:"error",variant:"text",onClick:ae=>L(o)},null,8,["onClick"])]),_:1},8,["items","loading","search"])]),_:1}),e(M,{modelValue:g.show,"onUpdate:modelValue":l[10]||(l[10]=o=>g.show=o),"max-width":"700px"},{default:t(()=>[e(h,null,{default:t(()=>[e(q,{class:"pa-6"},{default:t(()=>[i("span",be,p(g.isEdit?"Edit Product":"New Product"),1)]),_:1}),e(b,null,{default:t(()=>[e(oe,{ref_key:"form",ref:k,onSubmit:de(N,["prevent"])},{default:t(()=>[e(I,null,{default:t(()=>[e(C,null,{default:t(()=>[e(d,{cols:"12",class:"pb-0"},{default:t(()=>[e(Z,{modelValue:s.imageFile,"onUpdate:modelValue":l[4]||(l[4]=o=>s.imageFile=o),"image-preview":!0,accept:"image/*",label:"Product Image","prepend-icon":"mdi-camera","show-size":"",variant:"outlined",density:"comfortable"},{selection:t(({fileNames:o})=>[e(F,{size:"small",label:"",color:"primary",variant:"outlined"},{default:t(()=>[n(p(o[0]),1)]),_:2},1024)]),_:1},8,["modelValue"])]),_:1}),e(d,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[e(S,{modelValue:s.name,"onUpdate:modelValue":l[5]||(l[5]=o=>s.name=o),label:"Product Name",rules:[o=>!!o||"Name is required"],variant:"outlined",density:"comfortable"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[e(ee,{modelValue:s.category,"onUpdate:modelValue":l[6]||(l[6]=o=>s.category=o),items:U.value,label:"Category",rules:[o=>!!o||"Category is required"],variant:"outlined",density:"comfortable"},null,8,["modelValue","items","rules"])]),_:1}),e(d,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[e(S,{modelValue:s.price,"onUpdate:modelValue":l[7]||(l[7]=o=>s.price=o),modelModifiers:{number:!0},label:"Price",prefix:"$",type:"number",rules:[o=>!!o||"Price is required",o=>o>=0||"Price must be positive"],variant:"outlined",density:"comfortable"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[e(S,{modelValue:s.quantity,"onUpdate:modelValue":l[8]||(l[8]=o=>s.quantity=o),modelModifiers:{number:!0},label:"Quantity",type:"number",rules:[o=>!!o||"Stock is required",o=>o>=0||"Stock must be positive"],variant:"outlined",density:"comfortable"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",class:"pb-0"},{default:t(()=>[e(te,{modelValue:s.description,"onUpdate:modelValue":l[9]||(l[9]=o=>s.description=o),label:"Description",rows:"3",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),e(j,{class:"pa-6"},{default:t(()=>[e(T),e(v,{color:"error",variant:"outlined",onClick:$},{default:t(()=>[n(" Cancel ")]),_:1}),e(v,{color:"primary",variant:"elevated",onClick:N,loading:m.value},{default:t(()=>[n(" Save ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(M,{modelValue:u.show,"onUpdate:modelValue":l[12]||(l[12]=o=>u.show=o),"max-width":"400px"},{default:t(()=>[e(h,null,{default:t(()=>[e(q,{class:"pa-6 text-h5"},{default:t(()=>[n("Delete Product")]),_:1}),e(b,{class:"pa-6"},{default:t(()=>{var o;return[n(" Are you sure you want to delete "),i("strong",null,p((o=u.item)==null?void 0:o.name),1),n("? This action cannot be undone. ")]}),_:1}),e(j,{class:"pa-6"},{default:t(()=>[e(T),e(v,{color:"default",variant:"outlined",onClick:l[11]||(l[11]=o=>u.show=!1)},{default:t(()=>[n(" Cancel ")]),_:1}),e(v,{color:"error",variant:"elevated",onClick:R,loading:m.value},{default:t(()=>[n(" Delete ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(le,{modelValue:_.show,"onUpdate:modelValue":l[14]||(l[14]=o=>_.show=o),color:_.color,timeout:3e3},{actions:t(()=>[e(v,{color:"white",variant:"text",onClick:l[13]||(l[13]=o=>_.show=!1)},{default:t(()=>[n(" Close ")]),_:1})]),default:t(()=>[n(p(_.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})]),_:1})}}};export{xe as default};
