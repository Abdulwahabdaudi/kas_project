import{_ as _e}from"./AdminLayout-BrY3qDrv.js";import{r as c,h as x,i as fe,j as pe,e as s,o as T,c as ge,w as t,f as e,g as i,t as d,a as r,m as L,b as M,d as he,F as xe,O as be}from"./app-BWj68EOb.js";const ye=r("span",{class:"text-h5"},"Orders",-1),we={class:"font-weight-medium"},Ve=r("thead",null,[r("tr",null,[r("th",null,"Product"),r("th",{class:"text-right"},"Quantity"),r("th",{class:"text-right"},"Price"),r("th",{class:"text-right"},"Total")])],-1),Oe={class:"text-right"},ke={class:"text-right"},Ce={class:"text-right"},Pe={class:"font-weight-bold"},Ne=r("td",{colspan:"3",class:"text-right"},"Total:",-1),Se={class:"text-right"},Ue={class:"d-flex align-center"},$e={__name:"Orders",props:{notification:{type:Object,required:!0,default:()=>({show:!1,text:"",type:"info"})},orders:{type:Object,required:!0}},setup(Q,{expose:R}){const P=c(""),g=c(!1),h=c(!1);c([]);const b=c(""),$=c(10),w=c(-1),G=c([{title:"Order #",key:"orderNumber",align:"start"},{title:"Customer",key:"customerName"},{title:"Date",key:"date"},{title:"Total",key:"total",align:"end"},{title:"Status",key:"status",align:"center"},{title:"Actions",key:"actions",align:"end",sortable:!1}]),E=c(["Pending","Processing","Shipped","Delivered","Cancelled"]),F=c({orderNumber:"",customerName:"",email:"",phone:"",date:"",total:0,status:"",items:[]}),n=c({...F}),v=x(()=>j.orders),H=x(()=>{let a=[...v.value];return b.value&&(a=a.filter(o=>o.status===b.value)),a}),K=x(()=>v.value.filter(a=>a.status==="Delivered").length),W=x(()=>v.value.filter(a=>["Pending","Processing"].includes(a.status)).length),X=x(()=>v.value.filter(a=>a.status==="Cancelled").length),z=a=>({Pending:"warning",Processing:"info",Shipped:"primary",Delivered:"success",Cancelled:"error"})[a]||"grey",I=a=>(["Pending","Delivered"].includes(a),"white"),Y=a=>({Pending:"mdi-clock-outline",Processing:"mdi-cog-outline",Shipped:"mdi-truck-delivery-outline",Delivered:"mdi-check-circle-outline",Cancelled:"mdi-close-circle-outline"})[a]||"mdi-help-circle-outline",V=async()=>{g.value=!0,await new Promise(a=>setTimeout(a,1e3)),g.value=!1},Z=a=>{w.value=v.value.indexOf(a),n.value={...a},h.value=!0},ee=a=>{w.value=v.value.indexOf(a),n.value=JSON.parse(JSON.stringify(a)),h.value=!0},N=()=>{h.value=!1,setTimeout(()=>{n.value={...F},w.value=-1},300)},te=async()=>{g.value=!0;try{w.value>-1&&be.post(`/admin/orders/changeStatus/${n.value.orderNumber}`,n.value,{onSuccess:()=>{S("Product Update successfully")},onError:()=>{S("Error saving product. Please try again.","error")}})}catch{S("Error saving order","error")}finally{g.value=!1,N()}},_=c({show:!1,text:"",type:"info"}),S=(a,o="info")=>{_.value={show:!0,text:a,type:o},setTimeout(()=>{_.value.show=!1},3e3)};fe([b],()=>{V()},{deep:!0}),R({dialog:h,refreshOrders:V}),pe(()=>{V()});const j=Q,le=x(()=>{const a={success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information"};return a[j.notification.type]||a.info});return(a,o)=>{const O=s("v-card-subtitle"),y=s("v-card-title"),k=s("v-card-item"),f=s("v-card"),u=s("v-col"),U=s("v-row"),C=s("v-text-field"),q=s("v-select"),B=s("v-card-text"),D=s("v-icon"),p=s("v-btn"),ae=s("v-chip"),J=s("v-tooltip"),oe=s("v-data-table"),se=s("v-toolbar-title"),A=s("v-spacer"),ne=s("v-toolbar"),re=s("v-divider"),ie=s("v-table"),de=s("v-card-actions"),ce=s("v-dialog"),ue=s("v-container"),me=s("v-snackbar");return T(),ge(_e,null,{default:t(()=>[e(ue,{fluid:"",class:"pa-6"},{default:t(()=>[e(U,null,{default:t(()=>[e(u,{cols:"12",sm:"3"},{default:t(()=>[e(f,{class:"rounded-lg",elevation:"2"},{default:t(()=>[e(k,null,{default:t(()=>[e(O,{class:"text-primary-lighten-1 mb-1"},{default:t(()=>[i("Total Orders")]),_:1}),e(y,{class:"text-h4"},{default:t(()=>[i(d(v.value.length),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",sm:"3"},{default:t(()=>[e(f,{class:"rounded-lg",elevation:"2"},{default:t(()=>[e(k,null,{default:t(()=>[e(O,{class:"text-success-lighten-1 mb-1"},{default:t(()=>[i("Completed Orders")]),_:1}),e(y,{class:"text-h4"},{default:t(()=>[i(d(K.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",sm:"3"},{default:t(()=>[e(f,{class:"rounded-lg",elevation:"2"},{default:t(()=>[e(k,null,{default:t(()=>[e(O,{class:"text-warning-lighten-1 mb-1"},{default:t(()=>[i("Pending Orders")]),_:1}),e(y,{class:"text-h4"},{default:t(()=>[i(d(W.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",sm:"3"},{default:t(()=>[e(f,{class:"rounded-lg",elevation:"2"},{default:t(()=>[e(k,null,{default:t(()=>[e(O,{class:"text-error-lighten-1 mb-1"},{default:t(()=>[i("Cancelled Orders")]),_:1}),e(y,{class:"text-h4"},{default:t(()=>[i(d(X.value),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{class:"mt-6 rounded-lg",elevation:"2"},{default:t(()=>[e(B,null,{default:t(()=>[e(U,{align:"center"},{default:t(()=>[e(u,{cols:"12",sm:"4"},{default:t(()=>[e(C,{modelValue:P.value,"onUpdate:modelValue":o[0]||(o[0]=l=>P.value=l),label:"Search Orders","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",sm:"4"},{default:t(()=>[e(q,{modelValue:b.value,"onUpdate:modelValue":o[1]||(o[1]=l=>b.value=l),items:E.value,label:"Status",variant:"outlined",density:"comfortable","hide-details":"",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{class:"mt-6 rounded-lg",elevation:"2"},{default:t(()=>[e(y,{class:"d-flex justify-space-between align-center pa-6"},{default:t(()=>[ye,e(p,{color:"primary",variant:"elevated",onClick:V,loading:g.value},{default:t(()=>[e(D,{start:"",icon:"mdi-refresh"}),i(" Refresh ")]),_:1},8,["loading"])]),_:1}),e(oe,{"items-per-page":$.value,"onUpdate:itemsPerPage":o[2]||(o[2]=l=>$.value=l),headers:G.value,items:H.value,search:P.value,loading:g.value,hover:""},{"item.status":t(({item:l})=>[e(ae,{color:z(l.status),"text-color":I(l.status),size:"small",variant:"elevated"},{default:t(()=>[e(D,{start:"",icon:Y(l.status),size:"small"},null,8,["icon"]),i(" "+d(l.status),1)]),_:2},1032,["color","text-color"])]),"item.total":t(({item:l})=>[r("span",we,"$"+d(l.total),1)]),"item.actions":t(({item:l})=>[e(J,{location:"top",text:"View Details"},{activator:t(({props:m})=>[e(p,L({icon:"mdi-eye",size:"small",color:"primary",variant:"text",class:"mr-2"},m,{onClick:ve=>Z(l)}),null,16,["onClick"])]),_:2},1024),e(J,{location:"top",text:"Edit Order"},{activator:t(({props:m})=>[e(p,L({icon:"mdi-pencil",size:"small",color:"warning",variant:"text",class:"mr-2"},m,{onClick:ve=>ee(l)}),null,16,["onClick"])]),_:2},1024)]),_:1},8,["items-per-page","headers","items","search","loading"])]),_:1}),e(ce,{modelValue:h.value,"onUpdate:modelValue":o[7]||(o[7]=l=>h.value=l),"max-width":"800"},{default:t(()=>[e(f,null,{default:t(()=>[e(ne,{color:z(n.value.status),"text-color":I(n.value.status),density:"comfortable"},{default:t(()=>[e(se,null,{default:t(()=>[i(" Order #"+d(n.value.orderNumber),1)]),_:1}),e(A),e(p,{icon:"mdi-close",variant:"text",onClick:N})]),_:1},8,["color","text-color"]),e(B,{class:"pa-6"},{default:t(()=>[e(U,null,{default:t(()=>[e(u,{cols:"12",sm:"6"},{default:t(()=>[e(C,{modelValue:n.value.customerName,"onUpdate:modelValue":o[3]||(o[3]=l=>n.value.customerName=l),label:"Customer Name",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",sm:"6"},{default:t(()=>[e(q,{modelValue:n.value.status,"onUpdate:modelValue":o[4]||(o[4]=l=>n.value.status=l),items:E.value,label:"Status",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),e(u,{cols:"12",sm:"6"},{default:t(()=>[e(C,{modelValue:n.value.email,"onUpdate:modelValue":o[5]||(o[5]=l=>n.value.email=l),label:"Email",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",sm:"6"},{default:t(()=>[e(C,{modelValue:n.value.phone,"onUpdate:modelValue":o[6]||(o[6]=l=>n.value.phone=l),label:"Phone",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1}),e(re,{class:"my-4"}),e(ie,{density:"comfortable"},{default:t(()=>{var l;return[Ve,r("tbody",null,[(T(!0),M(xe,null,he(n.value.items,m=>(T(),M("tr",{key:m.id},[r("td",null,d(m.name),1),r("td",Oe,d(m.quantity),1),r("td",ke,"$"+d(Number(m.price).toFixed(2)),1),r("td",Ce,"$"+d((Number(m.quantity)*m.price).toFixed(2)),1)]))),128)),r("tr",Pe,[Ne,r("td",Se,"$"+d((l=Number(n.value.total))==null?void 0:l.toFixed(2)),1)])])]}),_:1})]),_:1}),e(de,null,{default:t(()=>[e(A),e(p,{color:"error",variant:"text",onClick:N},{default:t(()=>[i(" Cancel ")]),_:1}),e(p,{color:"primary",variant:"elevated",onClick:te},{default:t(()=>[i(" Save Changes ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),r("template",null,[e(me,{modelValue:_.value.show,"onUpdate:modelValue":o[9]||(o[9]=l=>_.value.show=l),color:_.value.type,location:"top right",timeout:3e3},{actions:t(()=>[e(p,{color:"white",variant:"text",icon:"mdi-close",onClick:o[8]||(o[8]=l=>_.value.show=!1)})]),default:t(()=>[r("div",Ue,[e(D,{icon:le.value,class:"mr-2",size:"small"},null,8,["icon"]),i(" "+d(_.value.text),1)])]),_:1},8,["modelValue","color"])])]),_:1})}}};export{$e as default};
